(function(){"use strict";var t=[],e=function(e,a,i){t.push({name:e,drawShape:a,drawBorder:i})},a=function(){return t},i=function(t){return function(e,a,i,l,n,r){r.fillStyle=n,r.beginPath(),t(e,a,i,l,r),r.closePath(),r.fill()}},l=function(t){return function(e,a,i,l,n,r){r.strokeStyle=n,r.lineWidth=l/5,r.beginPath(),t(e,a,i,l,r),r.closePath(),r.stroke()}},n=function(t,e,a,i,l){var n=45*Math.PI/180;l.moveTo(e+i*Math.sin(n),a-i*Math.cos(n));for(var r=1;4>r;r++)l.lineTo(e+Math.sin(n+2*Math.PI*r/4)*i,a-Math.cos(n+2*Math.PI*r/4)*i)};e("square",i(n),l(n));var r=function(t,e,a,i,l){l.arc(e,a,i,0,2*Math.PI,!0)};e("circle",i(r),l(r));var o=function(t,e,a,i,l){l.moveTo(e-i,a),l.lineTo(e,a-i),l.lineTo(e+i,a),l.lineTo(e,a+i)};e("diamond",i(o),l(o));var s=function(t,e,a,i,l){var n=t.cross&&t.cross.lineWeight||5;l.moveTo(e-i,a-n),l.lineTo(e-i,a+n),l.lineTo(e-n,a+n),l.lineTo(e-n,a+i),l.lineTo(e+n,a+i),l.lineTo(e+n,a+n),l.lineTo(e+i,a+n),l.lineTo(e+i,a-n),l.lineTo(e+n,a-n),l.lineTo(e+n,a-i),l.lineTo(e-n,a-i),l.lineTo(e-n,a-n)};e("cross",i(s),l(s));var c=function(t,e,a,i,l){var n=t.equilateral&&t.equilateral.numPoints||5,r=(t.equilateral&&t.equilateral.rotate||0)*Math.PI/180,o=i;l.moveTo(e+o*Math.sin(r),a-o*Math.cos(r));for(var s=1;n>s;s++)l.lineTo(e+Math.sin(r+2*Math.PI*s/n)*o,a-Math.cos(r+2*Math.PI*s/n)*o)};e("equilateral",i(c),l(c));var u=function(t,e,a,i,l){var n=t.star&&t.star.numPoints||5,r=t.star&&t.star.innerRatio||.5,o=i,s=i*r,c=Math.PI/n;l.moveTo(e,a-i);for(var u=0;n>u;u++)l.lineTo(e+Math.sin(c+2*Math.PI*u/n)*s,a-Math.cos(c+2*Math.PI*u/n)*s),l.lineTo(e+Math.sin(2*Math.PI*(u+1)/n)*o,a-Math.cos(2*Math.PI*(u+1)/n)*o)};e("star",i(u),l(u));var h=function(t,e,a,i,l,n){n.fillStyle="yellow",n.beginPath(),n.arc(e,a,i,1.25*Math.PI,0,!1),n.arc(e,a,i,0,.75*Math.PI,!1),n.lineTo(e,a),n.closePath(),n.fill(),n.fillStyle="white",n.strokeStyle="black",n.beginPath(),n.arc(e+i/3,a-i/3,i/4,0,2*Math.PI,!1),n.closePath(),n.fill(),n.stroke(),n.fillStyle="black",n.beginPath(),n.arc(e+4*i/9,a-i/3,i/8,0,2*Math.PI,!1),n.closePath(),n.fill()};e("pacman",h,null),this.ShapeLibrary={enumerate:a,version:"0.1"}}).call(this),function(t){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";if("undefined"==typeof ShapeLibrary)throw"ShapeLibrary is not declared";sigma.utils.pkg("sigma.canvas.nodes"),sigma.utils.pkg("sigma.svg.nodes");var e=t,a={},i=function(t){e=t},l=function(t,i,l,n,r){if(e&&t.image&&t.image.url){var o=t.image.url,s=t.image.h||1,c=t.image.w||1,u=t.image.scale||1,h=t.image.clip||1,d=a[o];d||(d=document.createElement("IMG"),d.src=o,d.status="loading",d.onerror=function(){console.log("error loading",o),d.status="error"},d.onload=function(){console.log("redraw on image load",o),d.status="ok",e.refresh()},a[o]=d);var f=s>c?c/s:1,m=c>s?s/c:1,g=n*u;r.save(),r.beginPath(),r.arc(i,l,n*h,0,2*Math.PI,!0),r.closePath(),r.clip(),"ok"===d.status&&r.drawImage(d,i+Math.sin(-.7855)*g*f,l-Math.cos(-.7855)*g*m,g*f*2*Math.sin(-.7855)*-1,g*m*2*Math.cos(-.7855)),r.restore()}},n=function(t,a,i){if(e&&t.image&&t.image.url){var l=document.createElementNS(i("xmlns"),"circle"),n=document.createElementNS(i("xmlns"),"clipPath"),r=i("classPrefix")+"-clip-path-"+t.id,o=document.createElementNS(i("xmlns"),"defs"),s=document.createElementNS(i("xmlns"),"image");t.image.url,n.setAttributeNS(null,"id",r),n.appendChild(l),o.appendChild(n);var c=/MSIE [5-9]/.test(navigator.userAgent)?"":document.location.href;c=c.split("#")[0],s.setAttributeNS(null,"class",i("classPrefix")+"-node-image"),s.setAttributeNS(null,"clip-path","url("+c+"#"+r+")"),s.setAttributeNS(null,"pointer-events","none"),s.setAttributeNS("http://www.w3.org/1999/xlink","href",t.image.url),a.appendChild(o),a.appendChild(s)}},r=function(t,e,a){sigma.canvas.nodes[t]=function(t,i,n){var r=n("prefix")||"",o=t[r+"size"],s=t.color||n("defaultNodeColor"),c=t.borderColor||s,u=t[r+"x"],h=t[r+"y"];i.save(),e&&e(t,u,h,o,s,i),a&&a(t,u,h,o,c,i),l(t,u,h,o,i),i.restore()},sigma.svg.nodes[t]={create:function(t,e){var a=document.createElementNS(e("xmlns"),"g"),i=document.createElementNS(e("xmlns"),"circle");return a.setAttributeNS(null,"class",e("classPrefix")+"-node-group"),a.setAttributeNS(null,"data-node-id",t.id),i.setAttributeNS(null,"data-node-id",t.id),i.setAttributeNS(null,"class",e("classPrefix")+"-node"),i.setAttributeNS(null,"fill",t.color||e("defaultNodeColor")),a.appendChild(i),n(t,a,e),a},update:function(t,e,a){for(var i=a("classPrefix"),l=t.image.clip||1,n=t.image.h||1,r=t.image.w||1,o=a("prefix")||"",s=t.image.scale||1,c=t[o+"size"],u=t[o+"x"],h=t[o+"y"],d=s*c,f=n>r?r/n:1,m=r>n?n/r:1,g=0,S=e.childNodes;g<S.length;g++){var p=S[g].getAttribute("class");switch(p){case i+"-node":S[g].setAttributeNS(null,"cx",u),S[g].setAttributeNS(null,"cy",h),S[g].setAttributeNS(null,"r",c),a("freeStyle")||S[g].setAttributeNS(null,"fill",t.color||a("defaultNodeColor"));break;case i+"-node-image":S[g].setAttributeNS(null,"x",u+Math.sin(-.7855)*d*f),S[g].setAttributeNS(null,"y",h-Math.cos(-.7855)*d*m),S[g].setAttributeNS(null,"width",d*f*2*Math.sin(-.7855)*-1),S[g].setAttributeNS(null,"height",d*m*2*Math.cos(-.7855));break;default:var v=S[g].firstChild;if(null!=v){var M=i+"-clip-path-"+t.id;v.getAttribute("id")===M&&(v.firstChild.setAttributeNS(null,"cx",u),v.firstChild.setAttributeNS(null,"cy",h),v.firstChild.setAttributeNS(null,"r",l*c))}}}e.style.display=""}}};ShapeLibrary.enumerate().forEach(function(t){r(t.name,t.drawShape,t.drawBorder)}),this.CustomShapes={init:i,version:"0.1"}}.call(this);